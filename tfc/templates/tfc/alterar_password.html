{% extends 'tfc/layout.html' %}

{% block content %}
{% load static %}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<style>
    .toggle-password {
        position: absolute;
        top: 45%;
        transform: translateY(-50%);
        right: 0;
        height: 100%;
        width: 60px;
        border: none;
        background: transparent;
        cursor: pointer;
        font-size: 18px;
        padding: 0;
        margin: 0;
        color: #555;
}

.form-control {
    padding-right: 40px
}

</style>

<div class="container">
    <h2>Alterar Password</h2>

    {% if messages %}
        {% for message in messages %}
            <div class="alert {% if message.tags %}alert-{{ message.tags }}{% endif %}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}

    <form method="post">
        {% csrf_token %}
        <div class="form-group" style="position: relative;">
            <label for="password_atual">Password Atual</label>
            <input type="password" name="password_atual" id="password_atual" required class="form-control" style="padding-right: 40px;">
            <button type="button" class="toggle-password" data-target="password_atual" style="position: absolute; top: 50%; right: 10px; transform: translateY(-50%); background: none; border: none;">
                <i class="bi bi-eye-slash"></i>
            </button>
        </div>

        <div class="form-group" style="position: relative;">
            <label for="nova_password">Nova Password</label>
            <input type="password" name="nova_password" id="nova_password" required class="form-control" style="padding-right: 40px;">
            <button type="button" class="toggle-password" data-target="nova_password" style="position: absolute; top: 50%; right: 10px; transform: translateY(-50%); background: none; border: none;">
                <i class="bi bi-eye-slash"></i>
            </button>
        </div>

        <div class="form-group" style="position: relative;">
            <label for="confirmar_password">Confirmar Nova Password</label>
            <input type="password" name="confirmar_password" id="confirmar_password" required class="form-control" style="padding-right: 40px;">
            <button type="button" class="toggle-password" data-target="confirmar_password" style="position: absolute; top: 50%; right: 10px; transform: translateY(-50%); background: none; border: none;">
                <i class="bi bi-eye-slash"></i>
            </button>
        </div>

        <button type="submit" class="btn btn-primary mt-3">Alterar Password</button>
    </form>
</div>

<script>
  document.querySelectorAll(".toggle-password").forEach(button => {
    button.addEventListener("click", () => {
      const targetId = button.getAttribute("data-target");
      const input = document.getElementById(targetId);
      const icon = button.querySelector("i");

      if (input.type === "password") {
        input.type = "text";
        icon.classList.remove("bi-eye-slash");
        icon.classList.add("bi-eye");
      } else {
        input.type = "password";
        icon.classList.remove("bi-eye");
        icon.classList.add("bi-eye-slash");
      }
    });
  });
</script>

{% endblock %}
